<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>XHR Demo</title>

  <style>
    body {
      font-family: "Poppins", Arial, sans-serif;
      background: #f7f9fc;
      display: flex;
      align-items: center;
      flex-direction: column;
      padding: 40px;
      color: #333;
    }

    h1 {
      margin-bottom: 8px;
    }

    p.lead {
      margin-top: 0;
      margin-bottom: 18px;
      color: #555;
    }

    #loadButton {
      background: #4a90e2;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.18s ease, box-shadow 0.18s ease;
      box-shadow: 0 6px 18px rgba(74,144,226,0.18);
    }

    #loadButton:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 10px 24px rgba(74,144,226,0.22);
    }

    #output {
      margin-top: 22px;
      background: #ffffff;
      width: 92%;
      max-width: 680px;
      padding: 18px;
      border-radius: 10px;
      box-shadow: 0px 6px 18px rgba(0,0,0,0.06);
      white-space: pre-wrap;
      min-height: 110px;
    }

    .meta {
      font-size: 13px;
      color: #666;
      margin-bottom: 8px;
    }

    .error {
      color: #d9534f;
      font-weight: 600;
    }

    .success {
      color: #2d8a45;
      font-weight: 600;
    }

    .spinner {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 3px solid rgba(0,0,0,0.08);
      border-top-color: rgba(0,0,0,0.35);
      border-radius: 50%;
      animation: spin 0.9s linear infinite;
      vertical-align: middle;
      margin-right: 8px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>

  <h1>‚ú® XMLHttpRequest Demo</h1>
  <p class="lead">Click the button below to load post data from a public API.</p>

  <button id="loadButton">üì¶ Load Post Data</button>

  <div id="output">The data will appear here...</div>

  <script>
    const loadButton = document.getElementById('loadButton');
    const outputDiv = document.getElementById('output');
    const apiUrl = 'https://jsonplaceholder.typicode.com/posts/1';

    loadButton.addEventListener('click', loadPostData);

    function setLoading() {
      outputDiv.className = '';
      outputDiv.innerHTML = '<span class="spinner"></span>‚è≥ Fetching data...';
    }

    function loadPostData() {
      setLoading();

      const xhr = new XMLHttpRequest();
      xhr.open('GET', apiUrl, true); // true = asynchronous

      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
          if (xhr.status === 200) {
            try {
              const post = JSON.parse(xhr.responseText);
              outputDiv.innerHTML = `
                <div class="meta">Fetched from: ${apiUrl}</div>
                <h2 class="success">‚úÖ Post Loaded Successfully</h2>
                <h3>üìå ${escapeHtml(post.title)}</h3>
                <p>${escapeHtml(post.body)}</p>
              `;
            } catch (e) {
              outputDiv.innerHTML = '<p class="error">‚ö†Ô∏è Error: Could not read the server response.</p>';
            }
          } else {
            outputDiv.innerHTML = `<p class="error">‚ùå Failed to load data (Status Code: ${xhr.status})</p>`;
          }
        }
      };

      xhr.onerror = function() {
        outputDiv.innerHTML = '<p class="error">‚ö†Ô∏è Network error. Please check your connection.</p>';
      };

      xhr.send();
    }

    function escapeHtml(str) {
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }
  </script>

</body>
</html>
